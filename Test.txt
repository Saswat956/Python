from datetime import datetime
from airflow import DAG
from airflow.operators.python_operator import PythonOperator

def run_script_y():
    # Code to run when the parameter is set to "Y"
    print("Running script Y")

def run_script_n():
    # Code to run when the parameter is set to "N"
    print("Running script N")

default_args = {
    'start_date': datetime(2023, 7, 12),
    'retries': 1,
    'retry_delay': timedelta(minutes=5)
}

dag = DAG('run_scripts_based_on_parameter', default_args=default_args, schedule_interval=None)

def choose_script(**context):
    parameter_value = context['dag_run'].conf.get('parameter_value')
    if parameter_value == 'Y':
        run_script_y()
    elif parameter_value == 'N':
        run_script_n()
    else:
        raise ValueError("Invalid parameter value. Expected 'Y' or 'N'.")

task = PythonOperator(
    task_id='choose_script_task',
    python_callable=choose_script,
    provide_context=True,
    dag=dag
)

# Define the dependencies
task
